# ä»»åŠ¡å¼€å‘æ¸…å• (Task List)
## ä¼ä¸šçº§åˆ†å¸ƒå¼ ID ç”Ÿæˆç³»ç»Ÿ

**ç‰ˆæœ¬**: v1.1  
**åˆ›å»ºæ—¥æœŸ**: 2025-12-24  
**é¡¹ç›®ç»ç†**: æŠ€æœ¯å›¢é˜Ÿ  
**çŠ¶æ€**: â³ å¾…æ‰§è¡Œ

---

## ä¸€ã€ä»»åŠ¡ä¼˜å…ˆçº§è¯´æ˜

| ä¼˜å…ˆçº§ | æ ‡è¯† | è¯´æ˜ | å…¸å‹ä»»åŠ¡ |
|-------|------|------|---------|
| **P0 - å…³é”®è·¯å¾„** | ğŸ”´ | é˜»å¡å…¶ä»–ä»»åŠ¡ï¼Œå¿…é¡»æœ€å…ˆå®Œæˆ | åŸºç¡€æ¡†æ¶ã€æ ¸å¿ƒç®—æ³• |
| **P1 - é«˜ä¼˜å…ˆçº§** | ğŸŸ  | æ ¸å¿ƒåŠŸèƒ½ï¼Œç›´æ¥å½±å“ä¸Šçº¿ | API å®ç°ã€æ•°æ®åº“è®¾è®¡ |
| **P2 - ä¸­ä¼˜å…ˆçº§** | ğŸŸ¡ | é‡è¦ä½†éé˜»å¡ | ç›‘æ§ã€å‘Šè­¦ |
| **P3 - ä½ä¼˜å…ˆçº§** | ğŸŸ¢ | å¯å»¶åå®ç° | ç®¡ç†åå°ä¼˜åŒ– |

---

## äºŒã€Phase 1: åŸºç¡€æ¶æ„ï¼ˆWeek 1-4ï¼‰

### é‡Œç¨‹ç¢‘ç›®æ ‡
- å®Œæˆé¡¹ç›®è„šæ‰‹æ¶å’ŒåŸºç¡€æ¡†æ¶
- å®ç° 3 ç§æ ¸å¿ƒç®—æ³•
- å•æœºå¯è¿è¡Œçš„æœåŠ¡
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%

---

### Sprint 1.0: ç¯å¢ƒå‡†å¤‡ (Week 0)

#### Task 1.0.1: å¼€å‘ç¯å¢ƒå®¹å™¨åŒ–ç¼–æ’ ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: åˆ›å»º docker-compose ä¸€é”®å¯åŠ¨å¼€å‘ç¯å¢ƒ

**å‰ç½®ä¾èµ–**: æ— 

**å®æ–½æ­¥éª¤**:
1. ç¼–å†™ `docker-compose.yml`
2. é…ç½® PostgreSQL å®¹å™¨ï¼ˆå«åˆå§‹åŒ–è„šæœ¬ï¼‰
3. é…ç½® Redis é›†ç¾¤ï¼ˆ3ä¸»3ä»ï¼‰
4. é…ç½® etcd é›†ç¾¤ï¼ˆ3èŠ‚ç‚¹ï¼‰
5. é…ç½® Prometheus + Grafana
6. ç¼–å†™ `Makefile` å¿«æ·å‘½ä»¤

**docker-compose.yml ç¤ºä¾‹**:
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:16-alpine
    environment:
      POSTGRES_DB: idgen
      POSTGRES_USER: idgen
      POSTGRES_PASSWORD: idgen123
    ports:
      - "5432:5432"
    volumes:
      - ./scripts/init.sql:/docker-entrypoint-initdb.d/init.sql
      - postgres_data:/var/lib/postgresql/data
  
  redis:
    image: redis:7.2-alpine
    ports:
      - "6379:6379"
    command: redis-server --appendonly yes
    volumes:
      - redis_data:/data
  
  etcd:
    image: quay.io/coreos/etcd:v3.5.11
    environment:
      ETCD_NAME: etcd0
      ETCD_LISTEN_CLIENT_URLS: http://0.0.0.0:2379
      ETCD_ADVERTISE_CLIENT_URLS: http://etcd:2379
    ports:
      - "2379:2379"
    volumes:
      - etcd_data:/etcd-data
  
  prometheus:
    image: prom/prometheus:latest
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
  
  grafana:
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
    environment:
      GF_SECURITY_ADMIN_PASSWORD: admin
    volumes:
      - grafana_data:/var/lib/grafana

volumes:
  postgres_data:
  redis_data:
  etcd_data:
  grafana_data:
```

**Makefile ç¤ºä¾‹**:
```makefile
.PHONY: dev-up dev-down dev-logs test

dev-up:
	docker-compose up -d

dev-down:
	docker-compose down

dev-logs:
	docker-compose logs -f

test:
	cargo test --all
```

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] `make dev-up` å¯ä¸€é”®å¯åŠ¨æ‰€æœ‰ä¾èµ–
- [ ] PostgreSQL è‡ªåŠ¨åˆå§‹åŒ–è¡¨ç»“æ„
- [ ] æ‰€æœ‰æœåŠ¡å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] æ–‡æ¡£ä¸­æœ‰è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜

---

### Sprint 1.1: é¡¹ç›®åˆå§‹åŒ– (Week 1)

#### Task 1.1.1: é¡¹ç›®è„šæ‰‹æ¶æ­å»º ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: åˆ›å»º Rust é¡¹ç›®ç»“æ„ï¼Œé…ç½®ä¾èµ–å’Œå·¥ä½œç©ºé—´

**å‰ç½®ä¾èµ–**: æ— 

**å®æ–½æ­¥éª¤**:
1. åˆ›å»º Cargo workspace
   ```bash
   cargo new idgen --lib
   cd idgen
   ```
2. é…ç½® `Cargo.toml`:
   ```toml
   [workspace]
   members = [
       "crates/core",
       "crates/server",
       "crates/client",
   ]
   ```
3. æ·»åŠ æ ¸å¿ƒä¾èµ–: tokio, axum, sea-orm, redis, etcd-client
4. é…ç½® CI/CD (GitHub Actions)
   - ä»£ç æ£€æŸ¥: `cargo clippy`
   - æ ¼å¼åŒ–: `cargo fmt`
   - æµ‹è¯•: `cargo test`

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] é¡¹ç›®ç»“æ„æ¸…æ™°ï¼Œæ¨¡å—åˆ’åˆ†åˆç†
- [ ] ä¾èµ–é…ç½®æ­£ç¡®ï¼Œå¯ç¼–è¯‘é€šè¿‡
- [ ] CI/CD æµæ°´çº¿è¿è¡ŒæˆåŠŸ

---

#### Task 1.1.2: é…ç½®ç®¡ç†æ¨¡å— ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å®ç°åŸºäº etcd çš„é…ç½®ç®¡ç†ï¼Œæ”¯æŒçƒ­æ›´æ–°

**å‰ç½®ä¾èµ–**: Task 1.1.1

**å®æ–½æ­¥éª¤**:
1. å®šä¹‰é…ç½®ç»“æ„ä½“
   ```rust
   #[derive(Debug, Clone, Deserialize)]
   pub struct Config {
       pub server: ServerConfig,
       pub database: DatabaseConfig,
       pub redis: RedisConfig,
       pub etcd: EtcdConfig,
   }
   ```
2. å®ç°é…ç½®åŠ è½½ï¼ˆæœ¬åœ°æ–‡ä»¶ + etcdï¼‰
3. å®ç°é…ç½® Watch æœºåˆ¶ï¼ˆetcd ç›‘å¬ï¼‰
4. å®ç°é…ç½®çƒ­æ›´æ–°ï¼ˆæ— éœ€é‡å¯ï¼‰

**é¢„ä¼°å·¥æ—¶**: 2 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ”¯æŒä» YAML æ–‡ä»¶åŠ è½½é…ç½®
- [ ] æ”¯æŒä» etcd åŠ è½½é…ç½®
- [ ] é…ç½®å˜æ›´è‡ªåŠ¨ç”Ÿæ•ˆï¼ˆ< 5ç§’ï¼‰
- [ ] é…ç½®æ ¡éªŒå®Œå–„

---

#### Task 1.1.3: æ—¥å¿—å’Œè¿½è¸ªæ¨¡å— ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: é›†æˆç»“æ„åŒ–æ—¥å¿—å’Œåˆ†å¸ƒå¼è¿½è¸ª

**å‰ç½®ä¾èµ–**: Task 1.1.1

**å®æ–½æ­¥éª¤**:
1. é…ç½® `tracing` å’Œ `tracing-subscriber`
2. å®šä¹‰æ—¥å¿—çº§åˆ«å’Œæ ¼å¼ï¼ˆJSONï¼‰
3. é›†æˆ OpenTelemetryï¼ˆå¯é€‰ï¼‰
4. å®ç°è¯·æ±‚è¿½è¸ªï¼ˆtrace_idï¼‰

**ä»£ç ç¤ºä¾‹**:
```rust
tracing_subscriber::fmt()
    .with_max_level(Level::INFO)
    .json()
    .init();

#[instrument(skip(ctx))]
async fn generate_id(ctx: &Context) -> Result<Id> {
    info!("Generating ID for {}", ctx.name);
    // ...
}
```

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] ç»“æ„åŒ–æ—¥å¿—è¾“å‡ºï¼ˆJSON æ ¼å¼ï¼‰
- [ ] æ—¥å¿—çº§åˆ«å¯é…ç½®
- [ ] å…³é”®æ“ä½œæœ‰æ—¥å¿—è®°å½•
- [ ] è¯·æ±‚è¿½è¸ª ID è´¯ç©¿æ•´ä¸ªè°ƒç”¨é“¾

---

### Sprint 1.2: æ•°æ®åº“è®¾è®¡ (Week 2)

#### Task 1.2.1: PostgreSQL è¡¨ç»“æ„è®¾è®¡ ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: è®¾è®¡å¹¶åˆ›å»ºæ•°æ®åº“è¡¨ç»“æ„

**å‰ç½®ä¾èµ–**: Task 1.1.1

**å®æ–½æ­¥éª¤**:
1. è®¾è®¡ 5 ä¸ªæ ¸å¿ƒè¡¨: `workspaces`, `groups`, `biz_tags`, `segments`, `api_keys`
2. ç¼–å†™ SQL è¿ç§»è„šæœ¬ï¼ˆä½¿ç”¨ SeaORM CLIï¼‰
3. åˆ›å»ºç´¢å¼•å’Œçº¦æŸ
4. é…ç½®è¡¨åˆ†åŒºï¼ˆ`segment_allocations` æŒ‰æœˆåˆ†åŒºï¼‰

**SQL ç¤ºä¾‹** (è§ TDD æ–‡æ¡£)

**é¢„ä¼°å·¥æ—¶**: 2 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] è¡¨ç»“æ„è®¾è®¡åˆç†ï¼Œç¬¦åˆè§„èŒƒåŒ–
- [ ] ç´¢å¼•åˆ›å»ºæ­£ç¡®
- [ ] å¤–é”®çº¦æŸé…ç½®
- [ ] è¿ç§»è„šæœ¬å¯é‡å¤æ‰§è¡Œ

---

#### Task 1.2.2: SeaORM å®ä½“å®šä¹‰ ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: æ ¹æ®è¡¨ç»“æ„ç”Ÿæˆ ORM å®ä½“

**å‰ç½®ä¾èµ–**: Task 1.2.1

**å®æ–½æ­¥éª¤**:
1. å®‰è£… SeaORM CLI: `cargo install sea-orm-cli`
2. ç”Ÿæˆå®ä½“: 
   ```bash
   sea-orm-cli generate entity -o crates/core/src/entity
   ```
3. æ‰‹åŠ¨è°ƒæ•´å®ä½“å®šä¹‰ï¼ˆå¦‚éœ€è¦ï¼‰
4. å®ç°å®ä½“é—´å…³ç³»æ˜ å°„

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰€æœ‰è¡¨å¯¹åº”çš„å®ä½“ç”Ÿæˆ
- [ ] å…³ç³»æ˜ å°„æ­£ç¡®ï¼ˆOneToMany, ManyToOneï¼‰
- [ ] è‡ªå®šä¹‰å­—æ®µï¼ˆå¦‚ JSONBï¼‰ç±»å‹æ­£ç¡®

---

#### Task 1.2.3: æ•°æ®åº“è¿æ¥æ± é…ç½® ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: é…ç½® PostgreSQL è¿æ¥æ± 

**å‰ç½®ä¾èµ–**: Task 1.2.2

**å®æ–½æ­¥éª¤**:
1. é…ç½®è¿æ¥æ± å‚æ•°
   ```rust
   let pool = PgPoolOptions::new()
       .max_connections(100)
       .min_connections(10)
       .acquire_timeout(Duration::from_secs(5))
       .connect(&database_url)
       .await?;
   ```
2. å®ç°è¿æ¥å¥åº·æ£€æŸ¥
3. å®ç°è¿æ¥æ± ç›‘æ§æŒ‡æ ‡

**é¢„ä¼°å·¥æ—¶**: 0.5 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] è¿æ¥æ± é…ç½®åˆç†
- [ ] è¿æ¥è·å–è¶…æ—¶å¤„ç†
- [ ] è¿æ¥æ± æŒ‡æ ‡å¯æŸ¥è¯¢

---

### Sprint 1.3: æ ¸å¿ƒç®—æ³•å®ç° (Week 3-4)

#### Task 1.3.1: ç®—æ³•æ¥å£å®šä¹‰ ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å®šä¹‰é€šç”¨çš„ç®—æ³•æ¥å£

**å‰ç½®ä¾èµ–**: Task 1.1.1

**å®æ–½æ­¥éª¤**:
1. å®šä¹‰ `IdAlgorithm` trait
   ```rust
   #[async_trait]
   pub trait IdAlgorithm: Send + Sync {
       async fn generate(&self, ctx: &GenerateContext) -> Result<Id>;
       async fn batch_generate(&self, ctx: &GenerateContext, size: usize) -> Result<Vec<Id>>;
       fn health_check(&self) -> HealthStatus;
       fn metrics(&self) -> AlgorithmMetrics;
   }
   ```
2. å®šä¹‰ `GenerateContext` ç»“æ„ä½“
3. å®šä¹‰ `Id` æšä¸¾ç±»å‹

**é¢„ä¼°å·¥æ—¶**: 0.5 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ¥å£è®¾è®¡åˆç†ï¼Œæ˜“äºæ‰©å±•
- [ ] æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥ç”Ÿæˆ
- [ ] åŒ…å«å¥åº·æ£€æŸ¥å’ŒæŒ‡æ ‡æ¥å£

---

#### Task 1.3.2: Segment å·æ®µç®—æ³•å®ç° ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å®ç°å·æ®µæ¨¡å¼ ID ç”Ÿæˆç®—æ³•

**å‰ç½®ä¾èµ–**: Task 1.2.2, Task 1.3.1

**å®æ–½æ­¥éª¤**:
1. å®ç° `SegmentAlgorithm` ç»“æ„ä½“
2. å®ç°åŒç¼“å†²æœºåˆ¶
   ```rust
   pub struct DoubleBuffer {
       current: Buffer,
       next: Option<Buffer>,
       switch_flag: AtomicBool,
   }
   ```
3. å®ç°å·æ®µåˆ†é…é€»è¾‘ï¼ˆä¹è§‚é”ï¼‰
4. å®ç°åŠ¨æ€æ­¥é•¿è®¡ç®—
   ```rust
   fn calculate_dynamic_step(&self, stats: &Statistics) -> u32 {
       let velocity = stats.qps / stats.current_step;
       let pressure = stats.cpu_usage;
       let next_step = self.base_step as f64 
           * (1.0 + 0.5 * velocity) 
           * (1.0 + 0.3 * pressure);
       next_step.clamp(self.min_step, self.max_step) as u32
   }
   ```
5. å®ç°å·æ®µé¢„åŠ è½½ï¼ˆå¼‚æ­¥ï¼‰

**é¢„ä¼°å·¥æ—¶**: 3 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] å•çº¿ç¨‹ç”Ÿæˆ ID æˆåŠŸ
- [ ] å¤šçº¿ç¨‹å¹¶å‘å®‰å…¨
- [ ] å·æ®µåˆ‡æ¢æ— ç¼
- [ ] åŠ¨æ€æ­¥é•¿è°ƒæ•´æ­£å¸¸
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%

---

#### Task 1.3.3: Snowflake ç®—æ³•å®ç°ï¼ˆä¿®æ­£ç‰ˆï¼‰ ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å®ç°æ”¹è¿›ç‰ˆé›ªèŠ±ç®—æ³•ï¼ˆå«é€»è¾‘æ—¶é’Ÿå’Œéé˜»å¡ç­‰å¾…ï¼‰

**å‰ç½®ä¾èµ–**: Task 1.3.1

**å®æ–½æ­¥éª¤**:
1. å®šä¹‰ ID ç»“æ„ï¼ˆ64ä½ï¼‰
2. å®ç°æ—¶é—´æˆ³ç”Ÿæˆï¼ˆæ¯«ç§’çº§ï¼‰
3. å®ç°åºåˆ—å· managementï¼ˆå•æ¯«ç§’å†…è‡ªå¢ï¼‰
4. **å®ç°ä¸‰çº§æ—¶é’Ÿå›æ‹¨å¤„ç†**:
   - å¾®å°å›æ‹¨ï¼ˆ< 5msï¼‰: éé˜»å¡ç­‰å¾…ï¼ˆoneshot channel + åå°ä»»åŠ¡ï¼‰
   - ä¸­ç­‰å›æ‹¨ï¼ˆ6-1000msï¼‰: é€»è¾‘æ—¶é’Ÿé€’å¢ï¼ˆSequence æº¢å‡ºé€»è¾‘ï¼‰
   - ä¸¥é‡å›æ‹¨ï¼ˆ> 1000msï¼‰: è‡ªåŠ¨é™çº§è‡³ UUID v7
5. å®ç°é€»è¾‘æ—¶é’Ÿç»´æŠ¤ï¼ˆåŸºäºæœ¬åœ°æ—¶é’Ÿ + åç§»è¡¥å¿ï¼‰
6. å®ç° ID ç»„è£…å’Œè§£æ

**é¢„ä¼°å·¥æ—¶**: 3 å¤©ï¼ˆåŸ 2 å¤© + 1 å¤©é€»è¾‘æ—¶é’Ÿ/éé˜»å¡é€»è¾‘ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- [ ] ID æ ¼å¼æ­£ç¡®ï¼ˆ64ä½ï¼‰
- [ ] ä¸‰çº§æ—¶é’Ÿå›æ‹¨å¤„ç†æ­£ç¡®
- [ ] é€»è¾‘æ—¶é’Ÿå•è°ƒé€’å¢
- [ ] å¾®å°å›æ‹¨æ—¶ä¸é˜»å¡ async runtime
- [ ] å•æ¯«ç§’æ”¯æŒ 1024 ä¸ª ID
- [ ] å¹¶å‘å®‰å…¨
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 85%

---

#### Task 1.3.4: UUID v7 ç®—æ³•å®ç° ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: å®ç°åŸºäºæ—¶é—´çš„ UUID v7

**å‰ç½®ä¾èµ–**: Task 1.3.1

**å®æ–½æ­¥éª¤**:
1. ä½¿ç”¨ `uuid` crate çš„ v7 å®ç°
   ```rust
   use uuid::Uuid;
   
   pub async fn generate(&self) -> Result<Id> {
       let uuid = Uuid::now_v7();
       Ok(Id::Uuid(uuid))
   }
   ```
2. å®ç° UUID åˆ°å­—ç¬¦ä¸²çš„è½¬æ¢

**é¢„ä¼°å·¥æ—¶**: 0.5 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] ç¬¦åˆ RFC 4122 æ ‡å‡†
- [ ] è¶‹åŠ¿é€’å¢
- [ ] å¹¶å‘å®‰å…¨

---

#### Task 1.3.5: ç®—æ³•è·¯ç”±å™¨å®ç° ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å®ç°ç®—æ³•é€‰æ‹©å’Œé™çº§é€»è¾‘

**å‰ç½®ä¾èµ–**: Task 1.3.2, Task 1.3.3, Task 1.3.4

**å®æ–½æ­¥éª¤**:
1. å®ç° `AlgorithmRouter` ç»“æ„ä½“
   ```rust
   pub struct AlgorithmRouter {
       algorithms: Vec<Box<dyn IdAlgorithm>>,
       current_index: AtomicUsize,
   }
   ```
2. å®ç°ç®—æ³•é€‰æ‹©é€»è¾‘ï¼ˆæ ¹æ®é…ç½®ï¼‰
3. å®ç°é™çº§é“¾
   ```
   Segment â†’ Snowflake â†’ UUID v7 â†’ UUID v4
   ```
4. å®ç°è‡ªåŠ¨æ¢å¤æœºåˆ¶ï¼ˆå¥åº·æ£€æŸ¥ï¼‰

**é¢„ä¼°å·¥æ—¶**: 2 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ ¹æ®é…ç½®é€‰æ‹©æ­£ç¡®ç®—æ³•
- [ ] æ•…éšœæ—¶è‡ªåŠ¨é™çº§
- [ ] æ¢å¤æ—¶è‡ªåŠ¨åˆ‡å›
- [ ] é™çº§äº‹ä»¶æœ‰æ—¥å¿—è®°å½•

---

### Sprint 1.4: HTTP/gRPC æœåŠ¡ (Week 4)

#### Task 1.4.1: HTTP API å®ç° ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: ä½¿ç”¨ axum å®ç° RESTful APIï¼Œå¹¶é›†æˆ API Key åŒçº§ç¼“å­˜è®¤è¯ä¸å®¡è®¡

**å‰ç½®ä¾èµ–**: Task 1.3.5

**å®æ–½æ­¥éª¤**:
1. å®šä¹‰è·¯ç”±ä¸è¯·æ±‚å¤„ç†å™¨
2. **å®ç° API Key è®¤è¯ä¸­é—´ä»¶**:
   - é›†æˆ L1 (DashMap) å’Œ L2 (Redis) åŒçº§ç¼“å­˜é€»è¾‘
   - å®ç° SHA256 å“ˆå¸Œæ ¡éªŒ
3. **å®ç°å®¡è®¡æ—¥å¿—ç³»ç»Ÿ**:
   - å¼‚æ­¥è®°å½• API è°ƒç”¨è¯¦æƒ…ï¼ˆWorkspace, Action, Result, Timestampï¼‰
   - æ”¯æŒå­˜å‚¨åˆ° PostgreSQL æˆ–å¤–éƒ¨æ—¥å¿—ç³»ç»Ÿ
4. å®ç°é”™è¯¯å¤„ç†ï¼ˆç»Ÿä¸€é”™è¯¯æ ¼å¼ï¼‰
5. æ·»åŠ é™æµä¸­é—´ä»¶ï¼ˆtower-governorï¼‰

**é¢„ä¼°å·¥æ—¶**: 3 å¤©ï¼ˆåŸ 2 å¤©ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰€æœ‰ç«¯ç‚¹æ­£å¸¸å·¥ä½œ
- [ ] API Key è®¤è¯é€šè¿‡ï¼ˆç¼“å­˜å‘½ä¸­ç‡ç›‘æ§ï¼‰
- [ ] å®¡è®¡æ—¥å¿—æ­£ç¡®è®°å½•
- [ ] é”™è¯¯å¤„ç†è§„èŒƒ
- [ ] API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ

---

#### Task 1.4.2: gRPC API å®ç° ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: ä½¿ç”¨ tonic å®ç° gRPC æœåŠ¡

**å‰ç½®ä¾èµ–**: Task 1.3.5

**å®æ–½æ­¥éª¤**:
1. ç¼–å†™ protobuf å®šä¹‰ï¼ˆè§ TDDï¼‰
2. ç”Ÿæˆ Rust ä»£ç : `cargo build`
3. å®ç° `IdService` trait
   ```rust
   #[tonic::async_trait]
   impl IdService for IdServiceImpl {
       async fn generate(
           &self,
           request: Request<GenerateRequest>,
       ) -> Result<Response<GenerateResponse>, Status> {
           // ...
       }
   }
   ```
4. é…ç½® gRPC æœåŠ¡å™¨

**é¢„ä¼°å·¥æ—¶**: 2 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰€æœ‰ RPC æ–¹æ³•æ­£å¸¸å·¥ä½œ
- [ ] æ€§èƒ½ä¼˜äº HTTPï¼ˆå»¶è¿Ÿé™ä½ 30%ï¼‰
- [ ] é›†æˆå¥åº·æ£€æŸ¥åè®®

---

#### Task 1.4.3: æœåŠ¡å¯åŠ¨å’Œä¼˜é›…å…³é—­ ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: å®ç°æœåŠ¡å¯åŠ¨ã€å¥åº·æ£€æŸ¥å’Œä¼˜é›…å…³é—­

**å‰ç½®ä¾èµ–**: Task 1.4.1, Task 1.4.2

**å®æ–½æ­¥éª¤**:
1. å®ç°æœåŠ¡å¯åŠ¨é€»è¾‘
   ```rust
   #[tokio::main]
   async fn main() -> Result<()> {
       // åŠ è½½é…ç½®
       let config = Config::load()?;
       
       // åˆå§‹åŒ–æ•°æ®åº“ã€Redisã€etcd
       let state = AppState::new(config).await?;
       
       // å¯åŠ¨ HTTP æœåŠ¡å™¨
       let http_server = axum::Server::bind(&addr)
           .serve(app.into_make_service());
       
       // å¯åŠ¨ gRPC æœåŠ¡å™¨
       let grpc_server = tonic::transport::Server::builder()
           .add_service(IdServiceServer::new(service));
       
       // ä¼˜é›…å…³é—­
       tokio::select! {
           _ = http_server => {},
           _ = grpc_server.serve(grpc_addr) => {},
           _ = signal::ctrl_c() => {
               info!("Shutting down...");
           }
       }
       
       Ok(())
   }
   ```
2. å®ç°å¥åº·æ£€æŸ¥ç«¯ç‚¹
3. å®ç°ä¼˜é›…å…³é—­ï¼ˆç­‰å¾…è¯·æ±‚å®Œæˆï¼‰

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æœåŠ¡æ­£å¸¸å¯åŠ¨
- [ ] å¥åº·æ£€æŸ¥è¿”å›æ­£ç¡®çŠ¶æ€
- [ ] Ctrl+C å¯ä¼˜é›…å…³é—­
- [ ] å…³é—­æ—¶ç­‰å¾…è¯·æ±‚å®Œæˆï¼ˆè¶…æ—¶ 30ç§’ï¼‰

---

### Phase 1 æ€»ç»“

**äº¤ä»˜ç‰©**:
- [x] å¯ç¼–è¯‘è¿è¡Œçš„å•æœºæœåŠ¡
- [x] 3 ç§ç®—æ³•å®ç°å¹¶é€šè¿‡å•å…ƒæµ‹è¯•
- [x] HTTP å’Œ gRPC API å¯ç”¨
- [x] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%

**é‡Œç¨‹ç¢‘éªŒæ”¶**: â³ å¾…éªŒæ”¶

---

## ä¸‰ã€Phase 2: ä¼ä¸šçº§ç‰¹æ€§ï¼ˆWeek 5-8ï¼‰

### é‡Œç¨‹ç¢‘ç›®æ ‡
- å®ç°å¤šçº§ç¼“å­˜
- å®ç°è·¨æ•°æ®ä¸­å¿ƒæ”¯æŒ
- å®ç°é«˜å¯ç”¨å’Œé™çº§ç­–ç•¥
- é€šè¿‡å‹åŠ›æµ‹è¯•ï¼ˆå•å®ä¾‹ QPS > 1,000,000ï¼‰

---

### Sprint 2.1: ç¼“å­˜å±‚å®ç° (Week 5-6)

#### Task 2.1.1: RingBuffer å®ç°ï¼ˆä¿®æ­£ç‰ˆï¼‰ ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å®ç°æ”¯æŒé€šç”¨ `Id` ç±»å‹çš„é«˜æ€§èƒ½ç¯å½¢ç¼“å†²åŒº

**å‰ç½®ä¾èµ–**: Task 1.3.2

**æŠ€æœ¯é€‰å‹**: `crossbeam::queue::ArrayQueue`

**å®æ–½æ­¥éª¤**:
1. æ·»åŠ ä¾èµ–: `crossbeam = "0.8"`
2. å®ç° `RingBuffer` ç»“æ„ä½“
   ```rust
   pub struct RingBuffer {
       queue: Arc<ArrayQueue<Id>>,
       capacity: usize,
       fill_threshold: usize,
   }
   ```
3. å®ç° `pop()` æ–¹æ³•ï¼ˆæ— é”ï¼‰
4. å®ç° `push_batch()` æ–¹æ³•
5. å®ç°å¼‚æ­¥å¡«å……è§¦å‘é€»è¾‘
6. å®ç°ç»Ÿè®¡æŒ‡æ ‡ï¼ˆå‘½ä¸­ç‡ã€å¡«å……é¢‘ç‡ï¼‰

**é¢„ä¼°å·¥æ—¶**: 2 å¤©ï¼ˆåŸ 3 å¤©ï¼Œä½¿ç”¨æˆç†Ÿåº“å‡å°‘å¼€å‘é‡ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ”¯æŒ `Id::Numeric` å’Œ `Id::Uuid` ç±»å‹
- [ ] Pop å»¶è¿Ÿ < 100ns
- [ ] å¹¶å‘å®‰å…¨ï¼ˆé€šè¿‡ loom æµ‹è¯•ï¼‰
- [ ] å†…å­˜å ç”¨ < 20 MB (1M å®¹é‡)
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 90%

---

#### Task 2.1.2: DoubleBuffer åŒç¼“å†²å®ç° ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å®ç°å·æ®µåŒç¼“å†²é¢„åŠ è½½æœºåˆ¶ï¼ˆæ›¿ä»£ DashMap æ–¹æ¡ˆï¼‰

**å‰ç½®ä¾èµ–**: Task 1.3.2 (Segment ç®—æ³•)

**å®æ–½æ­¥éª¤**:
1. å®ç° `DoubleBuffer` ç»“æ„ä½“
2. å®ç°åŸå­å·æ®µ `AtomicSegment`
3. å®ç°æ— ç¼åˆ‡æ¢é€»è¾‘ï¼ˆ10% é˜ˆå€¼è§¦å‘ï¼‰
4. å®ç°å¼‚æ­¥é¢„åŠ è½½ï¼ˆtokio::spawnï¼‰
5. å®ç°é¢„åŠ è½½å¤±è´¥é™çº§

**æ ¸å¿ƒä»£ç **:
```rust
pub struct DoubleBuffer {
    current: Arc<AtomicSegment>,
    next: Arc<RwLock<Option<Segment>>>,
    loader: Arc<SegmentLoader>,
}
```

**é¢„ä¼°å·¥æ—¶**: 3 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] å·æ®µåˆ‡æ¢æ— æ„ŸçŸ¥ï¼ˆå»¶è¿Ÿ < 1Î¼sï¼‰
- [ ] é¢„åŠ è½½æˆåŠŸç‡ > 99%
- [ ] å¹¶å‘å®‰å…¨ï¼ˆé€šè¿‡ miri æµ‹è¯•ï¼‰
- [ ] å·æ®µæµªè´¹ç‡ < 5%
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 85%

---

#### Task 2.1.3: Redis ç¼“å­˜é›†æˆ ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: é›†æˆ Redis ä½œä¸ºå…±äº«ç¼“å­˜

**å‰ç½®ä¾èµ–**: Task 2.1.2

**å®æ–½æ­¥éª¤**:
1. é…ç½® Redis å®¢æˆ·ç«¯ï¼ˆæ”¯æŒé›†ç¾¤æ¨¡å¼ï¼‰
2. å®ç°å·æ®µç¼“å­˜ï¼ˆKey: `segment:{biz_tag}:{dc_id}`)
3. è®¾ç½®åˆç†çš„ TTLï¼ˆ10 åˆ†é’Ÿï¼‰
4. å®ç°ç¼“å­˜é¢„çƒ­

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] ç¼“å­˜è¯»å†™æ­£å¸¸
- [ ] ç¼“å­˜å‘½ä¸­æ—¶ä¸è®¿é—®æ•°æ®åº“
- [ ] ç¼“å­˜è¿‡æœŸåè‡ªåŠ¨åˆ·æ–°

---

### Sprint 2.2: è·¨æ•°æ®ä¸­å¿ƒæ”¯æŒ (Week 7-8)

#### Task 2.2.1: etcd é›†æˆ ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: é›†æˆ etcd ä½œä¸ºé…ç½®ä¸­å¿ƒå’Œåè°ƒæœåŠ¡

**å‰ç½®ä¾èµ–**: Task 1.1.2

**å®æ–½æ­¥éª¤**:
1. é…ç½® etcd å®¢æˆ·ç«¯ï¼ˆè¿æ¥åˆ°é›†ç¾¤ï¼‰
2. å®ç°é…ç½®åŒæ­¥
   - Key: `/idgen/config/{workspace}/{group}/{biz_tag}`
3. å®ç° Watch æœºåˆ¶ï¼ˆç›‘å¬é…ç½®å˜æ›´ï¼‰
4. å®ç°æœåŠ¡å‘ç°
   - Key: `/idgen/nodes/{dc_id}/{node_id}`

**é¢„ä¼°å·¥æ—¶**: 2 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] é…ç½®å®æ—¶åŒæ­¥ï¼ˆ< 5ç§’ï¼‰
- [ ] Watch æœºåˆ¶ç¨³å®š
- [ ] etcd æ•…éšœæ—¶ä½¿ç”¨ç¼“å­˜é…ç½®

---

#### Task 2.2.2: DC_ID ç®¡ç† ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: å®ç°æ•°æ®ä¸­å¿ƒ ID åˆ†é…å’Œç®¡ç†

**å‰ç½®ä¾èµ–**: Task 2.2.1

**å®æ–½æ­¥éª¤**:
1. ä»ç¯å¢ƒå˜é‡æˆ– etcd è·å– DC_ID
2. éªŒè¯ DC_ID èŒƒå›´ï¼ˆ0-7ï¼‰
3. åœ¨å·æ®µåˆ†é…æ—¶ä½¿ç”¨ DC_ID éš”ç¦»
4. å®ç° DC_ID è·¯ç”±ï¼ˆè¯·æ±‚ä¼˜å…ˆæœ¬åœ° DCï¼‰

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] DC_ID æ­£ç¡®é…ç½®
- [ ] ä¸åŒ DC å·æ®µä¸å†²çª
- [ ] æœ¬åœ° DC ä¼˜å…ˆ

---

#### Task 2.2.3: è·¨ DC å·æ®µåè°ƒ ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å®ç°è·¨ DC å·æ®µåˆ†é…åè°ƒ

**å‰ç½®ä¾èµ–**: Task 2.2.2

**å®æ–½æ­¥éª¤**:
1. ä½¿ç”¨å…¨å±€å·æ®µè¡¨ + DC_ID åˆ†åŒº
2. å®ç°åˆ†å¸ƒå¼é”ï¼ˆåŸºäº etcdï¼‰é˜²æ­¢å†²çª
3. å®ç° DC é—´é…ç½®åŒæ­¥

**é¢„ä¼°å·¥æ—¶**: 2 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] ä¸åŒ DC ç”Ÿæˆçš„ ID å…¨å±€å”¯ä¸€
- [ ] åˆ†å¸ƒå¼é”æ­£å¸¸å·¥ä½œ
- [ ] é…ç½®åŒæ­¥å»¶è¿Ÿ < 5ç§’

---

#### Task 2.2.4: DC å·æ®µè‡ªåŠ¨åˆå§‹åŒ– ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å®ç°æ•°æ®ä¸­å¿ƒå·æ®µè‡ªåŠ¨åˆå§‹åŒ–å’Œå®¹é‡ç›‘æ§

**å‰ç½®ä¾èµ–**: Task 2.2.2 (DC_ID ç®¡ç†)

**å®æ–½æ­¥éª¤**:
1. å®ç°å·æ®µåˆå§‹åŒ–å‡½æ•° `initialize_dc_segments()`
2. åœ¨æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥å¹¶åˆå§‹åŒ–æœ¬ DC çš„å·æ®µ
3. å®ç°å·æ®µå®¹é‡ç›‘æ§ï¼ˆæ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡ï¼‰
4. é…ç½®å®¹é‡å‘Šè­¦ï¼ˆä½¿ç”¨ç‡ > 80%ï¼‰

**é¢„ä¼°å·¥æ—¶**: 2 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨åˆå§‹åŒ–å·æ®µ
- [ ] ä¸åŒ DC çš„å·æ®µåŒºé—´ä¸é‡å 
- [ ] å®¹é‡ç›‘æ§æ­£å¸¸å·¥ä½œ
- [ ] å‘Šè­¦è§¦å‘åŠæ—¶ï¼ˆä½¿ç”¨ç‡ > 80%ï¼‰

---

#### Task 2.2.5: Worker ID è‡ªåŠ¨åˆ†é… ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: å®ç°åŸºäº etcd çš„ worker_id è‡ªåŠ¨åˆ†é…å’Œå›æ”¶

**å‰ç½®ä¾èµ–**: Task 2.2.1 (etcd é›†æˆ)

**å®æ–½æ­¥éª¤**:
1. å®ç° `WorkerIdAllocator` ç»“æ„ä½“
2. å®ç° worker_id åˆ†é…é€»è¾‘ï¼ˆå°è¯• 0-255ï¼‰
3. å®ç°ç§Ÿçº¦ç»­æœŸï¼ˆåå°ä»»åŠ¡ï¼‰
4. å®ç°ä¼˜é›…é‡Šæ”¾ï¼ˆæœåŠ¡å…³é—­æ—¶ï¼‰
5. å®ç°åˆ†é…å¤±è´¥å‘Šè­¦

**é¢„ä¼°å·¥æ—¶**: 2 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨åˆ†é… worker_id
- [ ] ç§Ÿçº¦ç»­æœŸæ­£å¸¸ï¼ˆæ¯ 10ç§’ï¼‰
- [ ] Pod é‡å¯åå¯é‡æ–°åˆ†é…
- [ ] åˆ†é…å¤±è´¥æœ‰æ˜ç¡®å‘Šè­¦
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%

---

### Sprint 2.3: ç›‘æ§å’ŒæŒ‡æ ‡ (Week 8)

#### Task 2.3.1: Prometheus æŒ‡æ ‡é›†æˆ ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: é›†æˆ Prometheus æŒ‡æ ‡é‡‡é›†

**å‰ç½®ä¾èµ–**: Task 1.4.1

**å®æ–½æ­¥éª¤**:
1. å®šä¹‰æ ¸å¿ƒæŒ‡æ ‡ï¼ˆè§ TDDï¼‰
   - QPS: `idgen_generate_requests_total`
   - å»¶è¿Ÿ: `idgen_generate_duration_seconds`
   - å·æ®µä½¿ç”¨ç‡: `idgen_segment_usage_ratio`
2. å®ç°æŒ‡æ ‡é‡‡é›†
3. æš´éœ² `/metrics` ç«¯ç‚¹

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æŒ‡æ ‡æ­£ç¡®é‡‡é›†
- [ ] Prometheus å¯æŠ“å–
- [ ] æ ¸å¿ƒä¸šåŠ¡æŒ‡æ ‡é½å…¨

---

#### Task 2.3.2: åˆ†å¸ƒå¼è¿½è¸ª ğŸŸ¡ â³ å¾…å¼€å‘

**æè¿°**: é›†æˆ OpenTelemetry åˆ†å¸ƒå¼è¿½è¸ª

**å‰ç½®ä¾èµ–**: Task 1.1.3

**å®æ–½æ­¥éª¤**:
1. é…ç½® OpenTelemetry SDK
2. åœ¨å…³é”®è·¯å¾„æ·»åŠ  span
3. é…ç½®å¯¼å‡ºåˆ° Jaeger/Zipkin

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] è¿½è¸ªæ•°æ®å¯æŸ¥è¯¢
- [ ] è°ƒç”¨é“¾å®Œæ•´
- [ ] æ€§èƒ½å½±å“ < 5%

---

#### Task 2.3.3: ç™¾ä¸‡çº§ QPS æ€§èƒ½ä¼˜åŒ– ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: æ ¹æ® TDD 7.1 èŠ‚å®æ–½æ·±åº¦æ€§èƒ½ä¼˜åŒ–ï¼Œç¡®ä¿å•å®ä¾‹çªç ´ç™¾ä¸‡ QPS

**å‰ç½®ä¾èµ–**: Phase 2 æ‰€æœ‰æ ¸å¿ƒä»»åŠ¡

**å®æ–½æ­¥éª¤**:
1. **é›¶æ‹·è´ IO æ”¹é€ **: ä½¿ç”¨ `Bytes` å’Œ `tokio::io` æ¥å£
2. **æ— é”å¹¶å‘ä¼˜åŒ–**: ç§»é™¤çƒ­ç‚¹è·¯å¾„ä¸Šçš„äº’æ–¥é”ï¼Œæ”¹ç”¨åˆ†ç‰‡é”æˆ–æ— é”ç»“æ„
3. **å¼‚æ­¥æ‰¹å¤„ç†ä¼˜åŒ–**: ä¼˜åŒ–æ•°æ®åº“å·æ®µæ‹‰å–å’Œ ID é¢„ç”Ÿæˆé€»è¾‘
4. **è¿æ¥æ± ä¸ Runtime å¾®è°ƒ**: è°ƒä¼˜ `tokio` çº¿ç¨‹æ± å’Œ `sqlx` è¿æ¥æ± å‚æ•°
5. **JIT/å†…è”ä¼˜åŒ–**: æ ‡è®°çƒ­ç‚¹å‡½æ•°ä¸º `#[inline]`

**é¢„ä¼°å·¥æ—¶**: 3 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] å•å®ä¾‹ QPS > 1,000,000
- [ ] P99 å»¶è¿Ÿ < 10ms
- [ ] å‹æµ‹ä¸‹ CPU è´Ÿè½½å‡è¡¡
- [ ] å†…å­˜åˆ†é…ç‡æ˜¾è‘—é™ä½

---

### Phase 2 æ€»ç»“

**äº¤ä»˜ç‰©**:
- [x] å¤šçº§ç¼“å­˜æ­£å¸¸å·¥ä½œ
- [x] è·¨ DC éƒ¨ç½²æ”¯æŒ
- [x] å‹åŠ›æµ‹è¯•é€šè¿‡ï¼ˆå•å®ä¾‹ QPS > 1,000,000ï¼‰
- [x] Prometheus ç›‘æ§å¯ç”¨

**é‡Œç¨‹ç¢‘éªŒæ”¶**: â³ å¾…éªŒæ”¶

---

## å››ã€Phase 3: å¯è§‚æµ‹æ€§ï¼ˆWeek 9-11ï¼‰

### Sprint 3.1: Grafana ä»ªè¡¨ç›˜ (Week 9-10)

#### Task 3.1.1: æ ¸å¿ƒä»ªè¡¨ç›˜è®¾è®¡ ğŸŸ¡ â³ å¾…å¼€å‘

**æè¿°**: åˆ›å»º Grafana ä»ªè¡¨ç›˜

**å‰ç½®ä¾èµ–**: Task 2.3.1

**é¢æ¿åˆ—è¡¨**:
1. å®æ—¶ QPS è¶‹åŠ¿å›¾
2. P50/P90/P99 å»¶è¿Ÿåˆ†å¸ƒ
3. é”™è¯¯ç‡ç›‘æ§
4. å·æ®µä½¿ç”¨ç‡
5. ç®—æ³•ä½¿ç”¨åˆ†å¸ƒ
6. è·¨ DC æµé‡åˆ†å¸ƒ

**é¢„ä¼°å·¥æ—¶**: 2 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] ä»ªè¡¨ç›˜æ¸…æ™°æ˜“è¯»
- [ ] æ•°æ®å®æ—¶æ›´æ–°ï¼ˆ< 10ç§’ï¼‰
- [ ] æ”¯æŒæ—¶é—´èŒƒå›´é€‰æ‹©

---

#### Task 3.1.2: å‘Šè­¦è§„åˆ™é…ç½® ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: é…ç½® AlertManager å‘Šè­¦è§„åˆ™

**å‰ç½®ä¾èµ–**: Task 2.3.1

**å‘Šè­¦è§„åˆ™**:
1. QPS å¼‚å¸¸ï¼ˆè¿‡é«˜/è¿‡ä½ï¼‰
2. å»¶è¿Ÿè¶…è¿‡é˜ˆå€¼ï¼ˆP99 > 10msï¼‰
3. é”™è¯¯ç‡è¶…è¿‡é˜ˆå€¼ï¼ˆ> 1%ï¼‰
4. å·æ®µå³å°†è€—å°½ï¼ˆ< 10%ï¼‰
5. æ•°æ®åº“è¿æ¥å¤±è´¥
6. ç®—æ³•é™çº§äº‹ä»¶

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] å‘Šè­¦è§„åˆ™æ­£ç¡®é…ç½®
- [ ] å‘Šè­¦è§¦å‘åŠæ—¶ï¼ˆ< 1åˆ†é’Ÿï¼‰
- [ ] å‘Šè­¦é€šçŸ¥é€è¾¾ï¼ˆé‚®ä»¶/ä¼ä¸šå¾®ä¿¡ï¼‰

---

### Sprint 3.2: ç®¡ç†åå° (Week 11)

#### Task 3.2.1: é…ç½®ç®¡ç†ç•Œé¢ ğŸŸ¡ â³ å¾…å¼€å‘

**æè¿°**: å¼€å‘é…ç½®ç®¡ç† Web ç•Œé¢

**å‰ç½®ä¾èµ–**: Task 1.2.2

**æŠ€æœ¯æ ˆ**: Rust + axum + HTMX + Tailwind CSS

**åŠŸèƒ½**:
3. Workspace ç®¡ç†ï¼ˆCRUDï¼‰
4. Group ç®¡ç†ï¼ˆCRUDï¼‰
5. ä¸šåŠ¡æ ‡ç­¾ (biz_tag) ç®¡ç†ï¼ˆCRUDï¼‰
6. é…ç½®è¡¨å•ï¼ˆç®—æ³•é€‰æ‹©ã€å‚æ•°é…ç½®ï¼‰

**é¢„ä¼°å·¥æ—¶**: 3 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] UI ç¾è§‚æ˜“ç”¨
- [ ] è¡¨å•éªŒè¯å®Œå–„
- [ ] æ“ä½œå“åº”å¿«ï¼ˆ< 500msï¼‰
- [ ] æ”¯æŒæ‰¹é‡æ“ä½œ

---

#### Task 3.2.2: ç›‘æ§å¤§ç›˜é›†æˆ ğŸŸ¡ â³ å¾…å¼€å‘

**æè¿°**: åœ¨ç®¡ç†åå°é›†æˆ Grafana ä»ªè¡¨ç›˜

**å‰ç½®ä¾èµ–**: Task 3.1.1, Task 3.2.1

**å®æ–½æ­¥éª¤**:
1. ä½¿ç”¨ iframe åµŒå…¥ Grafana ä»ªè¡¨ç›˜
2. æ·»åŠ å¿«æ·ç­›é€‰ï¼ˆä¸šåŠ¡å•å…ƒã€æ—¶é—´èŒƒå›´ï¼‰
3. æ·»åŠ æŒ‡æ ‡æ±‡æ€»å¡ç‰‡

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] ä»ªè¡¨ç›˜æ­£å¸¸å±•ç¤º
- [ ] ç­›é€‰åŠŸèƒ½æ­£å¸¸
- [ ] æ±‡æ€»æŒ‡æ ‡å‡†ç¡®

---

### Phase 3 æ€»ç»“

**äº¤ä»˜ç‰©**:
- [x] Grafana ä»ªè¡¨ç›˜å®Œæ•´
- [x] å‘Šè­¦è§„åˆ™é…ç½®å®Œæˆ
- [x] ç®¡ç†åå°åŸºæœ¬å¯ç”¨

**é‡Œç¨‹ç¢‘éªŒæ”¶**: â³ å¾…éªŒæ”¶

---

## äº”ã€Phase 4: ä¼˜åŒ–ä¸ä¸Šçº¿ï¼ˆWeek 12-14ï¼‰

### Sprint 4.1: æ€§èƒ½ä¼˜åŒ– (Week 12)

#### Task 4.1.1: ç™¾ä¸‡çº§ QPS æ€§èƒ½è°ƒä¼˜ ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å‹åŠ›æµ‹è¯•å¹¶ä¼˜åŒ–è‡³ç™¾ä¸‡çº§ QPS

**ä¼˜åŒ–è·¯å¾„**:
1. **åŸºå‡†æµ‹è¯•** (ç›®æ ‡: 100K QPS)
   - åŸå§‹å®ç°æ€§èƒ½æµ‹è¯•
   - ç¡®å®šæ€§èƒ½ç“¶é¢ˆï¼ˆCPU/å†…å­˜/IOï¼‰

2. **ç¬¬ä¸€è½®ä¼˜åŒ–** (ç›®æ ‡: 500K QPS)
   - RingBuffer é¢„ç”Ÿæˆä¼˜åŒ–
   - è¿æ¥æ± å‚æ•°è°ƒä¼˜
   - å¼‚æ­¥ä»»åŠ¡è°ƒåº¦ä¼˜åŒ–

3. **ç¬¬äºŒè½®ä¼˜åŒ–** (ç›®æ ‡: 1M QPS)
   - é›¶æ‹·è´ IO
   - æ— é”æ•°æ®ç»“æ„
   - SIMD åŠ é€Ÿï¼ˆå¦‚é€‚ç”¨ï¼‰

4. **ç¬¬ä¸‰è½®ä¼˜åŒ–** (ç›®æ ‡: 1.5M+ QPS)
   - ç«ç„°å›¾åˆ†æçƒ­ç‚¹
   - æ±‡ç¼–çº§ä¼˜åŒ–å…³é”®è·¯å¾„
   - å†…å­˜åˆ†é…å™¨ä¼˜åŒ–ï¼ˆjemallocï¼‰

**é¢„ä¼°å·¥æ—¶**: 5 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] å•å®ä¾‹ QPS > 1,000,000
- [ ] P99 å»¶è¿Ÿ < 10ms
- [ ] CPU ä½¿ç”¨ç‡ < 85%
- [ ] æ€§èƒ½æµ‹è¯•æŠ¥å‘Šå®Œæ•´

---

#### Task 4.1.2: å†…å­˜ä¼˜åŒ– ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: ä¼˜åŒ–å†…å­˜å ç”¨

**å‰ç½®ä¾èµ–**: Task 4.1.1

**ä¼˜åŒ–ç­–ç•¥**:
1. RingBuffer å¤§å°è°ƒä¼˜
2. ç¼“å­˜ LRU å®¹é‡è°ƒä¼˜
3. å¯¹è±¡æ± å¤ç”¨
4. å†…å­˜æ³„æ¼æ£€æµ‹

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] åˆå§‹å†…å­˜ < 500MB
- [ ] ç¨³å®šåå†…å­˜ < 2GB
- [ ] æ— å†…å­˜æ³„æ¼

---

### Sprint 4.2: å®‰å…¨åŠ å›º (Week 13)

#### Task 4.2.1: TLS åŠ å¯†é…ç½® ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: é…ç½® TLS 1.3 åŠ å¯†

**å‰ç½®ä¾èµ–**: Task 1.4.1

**å®æ–½æ­¥éª¤**:
1. ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼ˆæµ‹è¯•ï¼‰æˆ–ä½¿ç”¨ Let's Encrypt
2. é…ç½® HTTP æœåŠ¡å™¨ TLS
3. é…ç½® gRPC æœåŠ¡å™¨ TLS
4. å¼ºåˆ¶ HTTPSï¼ˆé‡å®šå‘ HTTPï¼‰

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] HTTPS æ­£å¸¸å·¥ä½œ
- [ ] TLS 1.3 æ¡æ‰‹æˆåŠŸ
- [ ] HTTP è¯·æ±‚è¢«é‡å®šå‘

---

#### Task 4.2.2: API é™æµ ğŸŸ  â³ å¾…å¼€å‘

**æè¿°**: å®ç° API é™æµ

**å‰ç½®ä¾èµ–**: Task 1.4.1

**å®æ–½æ­¥éª¤**:
1. ä½¿ç”¨ `tower-governor` å®ç°é™æµ
2. é…ç½®é™æµè§„åˆ™ï¼ˆ1000 QPS/IPï¼‰
3. è¿”å›å‹å¥½çš„é™æµæç¤º

**é¢„ä¼°å·¥æ—¶**: 0.5 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] é™æµç”Ÿæ•ˆ
- [ ] è¶…é™è¿”å› 429 çŠ¶æ€ç 
- [ ] æç¤ºä¿¡æ¯æ¸…æ™°

---

#### Task 4.2.3: å®¡è®¡æ—¥å¿—å®Œå–„ ğŸŸ¡ â³ å¾…å¼€å‘

**æè¿°**: å®Œå–„å®¡è®¡æ—¥å¿—åŠŸèƒ½

**å‰ç½®ä¾èµ–**: Task 1.1.3

**å®æ–½æ­¥éª¤**:
1. è®°å½•æ‰€æœ‰é…ç½®å˜æ›´
2. è®°å½•é™çº§äº‹ä»¶
3. è®°å½•å‘Šè­¦äº‹ä»¶
4. å®ç°æ—¥å¿—æŸ¥è¯¢æ¥å£

**é¢„ä¼°å·¥æ—¶**: 1 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰€æœ‰å…³é”®æ“ä½œè¢«è®°å½•
- [ ] æ—¥å¿—æ ¼å¼è§„èŒƒ
- [ ] æ—¥å¿—å¯æŸ¥è¯¢

---

### Sprint 4.3: ç”Ÿäº§å‡†å¤‡ (Week 14)

#### Task 4.3.1: Kubernetes éƒ¨ç½²é…ç½® ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: ç¼–å†™ Kubernetes éƒ¨ç½² YAMLï¼Œå¹¶å®ç°åŸºäº Secrets çš„æ•æ„Ÿä¿¡æ¯ç®¡ç†ï¼ˆå¦‚æ•°æ®åº“å¯†ç ã€API Key ç­‰ï¼‰

**å‰ç½®ä¾èµ–**: Phase 3 å®Œæˆ

**äº¤ä»˜æ–‡ä»¶**:
- `deployment.yaml`
- `service.yaml`
- `configmap.yaml`
- `secret.yaml`
- `hpa.yaml`
- `ingress.yaml`

**é¢„ä¼°å·¥æ—¶**: 2 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] éƒ¨ç½²æˆåŠŸ
- [ ] å¥åº·æ£€æŸ¥æ­£å¸¸
- [ ] HPA è‡ªåŠ¨æ‰©ç¼©å®¹
- [ ] Ingress æµé‡æ­£å¸¸

---

#### Task 4.3.2: æ–‡æ¡£ç¼–å†™ ğŸŸ¡ â³ å¾…å¼€å‘

**æè¿°**: ç¼–å†™å®Œæ•´çš„æŠ€æœ¯æ–‡æ¡£

**æ–‡æ¡£æ¸…å•**:
1. éƒ¨ç½²æ–‡æ¡£ï¼ˆDeployment Guideï¼‰
2. è¿ç»´æ–‡æ¡£ï¼ˆOperations Guideï¼‰
3. API æ–‡æ¡£ï¼ˆOpenAPI è§„èŒƒï¼‰
4. SDK ä½¿ç”¨æ–‡æ¡£
5. æ•…éšœæ’æŸ¥æ‰‹å†Œï¼ˆTroubleshootingï¼‰

**é¢„ä¼°å·¥æ—¶**: 3 å¤©

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ–‡æ¡£æ¸…æ™°å®Œæ•´
- [ ] ä»£ç ç¤ºä¾‹å¯è¿è¡Œ
- [ ] æ•…éšœæ’æŸ¥æœ‰æ•ˆ

---

#### Task 4.3.3: ç°åº¦å‘å¸ƒ ğŸ”´ â³ å¾…å¼€å‘

**æè¿°**: å®æ–½ç°åº¦å‘å¸ƒ

**å‰ç½®ä¾èµ–**: Task 4.3.1

**å‘å¸ƒæ­¥éª¤**:
1. éƒ¨ç½² 1 ä¸ªèŠ‚ç‚¹ï¼ˆ5% æµé‡ï¼‰
2. è§‚å¯Ÿ 24 å°æ—¶
3. æ‰©å±•åˆ° 3 ä¸ªèŠ‚ç‚¹ï¼ˆ50% æµé‡ï¼‰
4. è§‚å¯Ÿ 24 å°æ—¶
5. å…¨é‡å‘å¸ƒï¼ˆ100% æµé‡ï¼‰

**é¢„ä¼°å·¥æ—¶**: 3 å¤©ï¼ˆå«è§‚å¯Ÿæ—¶é—´ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- [ ] ç°åº¦å‘å¸ƒæ— æ•…éšœ
- [ ] æ ¸å¿ƒæŒ‡æ ‡æ­£å¸¸
- [ ] ä¸šåŠ¡ç³»ç»Ÿæ— æ„ŸçŸ¥

---

### Phase 4 æ€»ç»“

**äº¤ä»˜ç‰©**:
- [x] æ€§èƒ½ä¼˜åŒ–å®Œæˆ
- [x] å®‰å…¨åŠ å›ºå®Œæˆ
- [x] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- [x] å®Œæ•´æ–‡æ¡£äº¤ä»˜

**æœ€ç»ˆéªŒæ”¶**: â³ å¾…éªŒæ”¶

---

## å…­ã€ä»»åŠ¡æ€»è§ˆ

### ä»»åŠ¡ç»Ÿè®¡

| Phase | ä»»åŠ¡æ•° | P0 | P1 | P2 | P3 | é¢„ä¼°æ€»å·¥æ—¶ | çŠ¶æ€ |
|-------|-------|----|----|----|----|-----------|------|
| **Phase 1** | 13 | 8 | 3 | 2 | 0 | 23 å¤© | â³ å¾…å¼€å§‹ |
| **Phase 2** | 8 | 3 | 4 | 1 | 0 | 15 å¤© | â³ å¾…å¼€å§‹ |
| **Phase 3** | 4 | 0 | 1 | 3 | 0 | 8 å¤© | â³ å¾…å¼€å§‹ |
| **Phase 4** | 7 | 2 | 3 | 2 | 0 | 14 å¤© | â³ å¾…å¼€å§‹ |
| **æ€»è®¡** | **32** | **13** | **11** | **8** | **0** | **60 å¤©** | â³ å¾…å¼€å§‹ |

### å…³é”®è·¯å¾„ä»»åŠ¡

```mermaid
gantt
    title åˆ†å¸ƒå¼ ID ç”Ÿæˆç³»ç»Ÿ - å…³é”®è·¯å¾„
    dateFormat  YYYY-MM-DD
    
    section Phase 1
    é¡¹ç›®åˆå§‹åŒ–           :p1, 2025-12-23, 1d
    é…ç½®ç®¡ç†æ¨¡å—         :p2, after p1, 2d
    æ•°æ®åº“è®¾è®¡           :p3, after p1, 3d
    Segment ç®—æ³•         :p4, after p3, 3d
    Snowflake ç®—æ³•       :p5, after p3, 2d
    ç®—æ³•è·¯ç”±å™¨           :p6, after p4 p5, 2d
    HTTP/gRPC API        :p7, after p6, 4d
    
    section Phase 2
    RingBuffer å®ç°      :p8, after p7, 3d
    etcd é›†æˆ            :p9, after p7, 2d
    è·¨ DC åè°ƒ           :p10, after p9, 2d
    
    section Phase 3
    ç›‘æ§æŒ‡æ ‡é›†æˆ         :p11, after p10, 1d
    Grafana ä»ªè¡¨ç›˜       :p12, after p11, 2d
    
    section Phase 4
    æ€§èƒ½å‹æµ‹è°ƒä¼˜         :p13, after p12, 3d
    K8s éƒ¨ç½²é…ç½®         :p14, after p13, 2d
    ç°åº¦å‘å¸ƒ             :p15, after p14, 3d
```

---

## ä¸ƒã€é£é™©ä¸ä¾èµ–

### é«˜é£é™©ä»»åŠ¡

| ä»»åŠ¡ | é£é™© | åº”å¯¹æªæ–½ | çŠ¶æ€ |
|------|------|---------|------|
| Task 1.3.2 (Segment) | å¹¶å‘ç«äº‰å¯¼è‡´ ID é‡å¤ | å……åˆ†çš„å•å…ƒæµ‹è¯•ï¼Œå‹åŠ›æµ‹è¯• | â³ å¾…è¯„ä¼° |
| Task 2.1.1 (RingBuffer) | Lock-free ç®—æ³•å¤æ‚ | ä½¿ç”¨æˆç†Ÿåº“ï¼Œmiri æµ‹è¯• | â³ å¾…è¯„ä¼° |
| Task 4.1.1 (æ€§èƒ½å‹æµ‹) | æ€§èƒ½ä¸è¾¾æ ‡ | æå‰ POCï¼Œé¢„ç•™ä¼˜åŒ–æ—¶é—´ | â³ å¾…è¯„ä¼° |

### å¤–éƒ¨ä¾èµ–

| ä¾èµ–é¡¹ | è´Ÿè´£æ–¹ | çŠ¶æ€ | å¤‡æ³¨ |
|-------|--------|------|------|
| PostgreSQL é›†ç¾¤ | DBA å›¢é˜Ÿ | â³ å¾…æ­å»º | Week 2 å‰å°±ç»ª |
| Redis é›†ç¾¤ | DBA å›¢é˜Ÿ | â³ å¾…æ­å»º | Week 5 å‰å°±ç»ª |
| etcd é›†ç¾¤ | è¿ç»´å›¢é˜Ÿ | â³ å¾…æ­å»º | Week 7 å‰å°±ç»ª |
| Kubernetes é›†ç¾¤ | è¿ç»´å›¢é˜Ÿ | â³ å¾…æ­å»º | Week 12 å‰å°±ç»ª |

---

**æ–‡æ¡£çŠ¶æ€**: â³ å¾…æ‰§è¡Œ  
**ä¸‹æ¬¡æ›´æ–°æ—¥æœŸ**: æ¯å‘¨äº”  
**é¡¹ç›®ç»ç†**: æŠ€æœ¯è´Ÿè´£äºº